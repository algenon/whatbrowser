/**
 * whatbrowser.ru, version 0.1.0
 *
 * whatbrowser.ru is freely distributable under the terms of MIT-style license
 * For details, see http://whatbrowser.ru
 */

"use strict";(function init($,UAParser){var navigator=window.navigator;var document=window.document;function resolutionToStr(width,height){return width+" × "+height+" px"}function browserSize(source){var value=source&&source.browser_size||{height:$(window).height(),width:$(window).width()};value.toString=function(){return resolutionToStr(value.width,value.height)};return value}function cookies(source){function hasCookies(){if(navigator.cookieEnabled){return true}document.cookie="cookietest=1";var ret=document.cookie.indexOf("cookietest=")!==-1;document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT";return ret}return source&&source.cookies||hasCookies()}function javafn(source){var value=source&&source.java||{enabled:navigator.javaEnabled&&navigator.javaEnabled(),version:null};value.toString=function(){return value.enabled?value.version||"да":"нет"};return value}function language(source){return source&&source.language||navigator.language||navigator.userLanguage}function online(source){return source&&source.online||navigator.onLine}function screenfn(source){var value=source&&source.screen||window.screen&&{color_depth:window.screen.colorDepth,pixel_ratio:window.devicePixelRatio,height:window.screen.height,width:window.screen.width};value.toString=function(){var str="";if(value){var resolution=resolutionToStr(value.width,value.height);var depth=value.color_depth+" bit";str=resolution+", "+depth;if(value.pixel_ratio&&value.pixel_ratio>1){var retinaResolution=resolutionToStr(value.width*value.pixel_ratio,value.height*value.pixel_ratio);str+=" (retina "+retinaResolution+")"}}return str};return value}function ua(source){function browserToString(browser){var str=browser.name||"";str+=browser.major&&" "+browser.major||"";str+=browser.version&&" ("+browser.version+")"||"";return str}function deviceToString(device){var str=device.vendor||"";str+=device.model&&" "+device.model||"";str+=device.type&&" ("+device.type+")"||"";return str}function engineToString(engine){var str=engine.name||"";str+=engine.version&&" "+engine.version||"";return str}function osToString(os){var str=os.name||"";str+=os.version&&" "+os.version||"";return str}var value={};if(UAParser){value=source&&source.ua||(new UAParser).getResult();value.toString=function(){return value.ua};value.browser.toString=function(){return browserToString(value.browser)};value.device.toString=function(){return deviceToString(value.device)};value.engine.toString=function(){return engineToString(value.engine)};value.os.toString=function(){return osToString(value.os)}}else{value={ua:navigator.userAgent}}return value}function geo(source){function positionToString(position){return position.latitude?position.latitude+", "+position.longitude:""}function addressToString(address){var str=address.country||"";str+=address.region&&"', "+address.region||"";str+=address.city&&"', "+address.city||"";return str}var value=source;if(value&&value.position){value.position.toString=function(){return positionToString(value.position)}}if(value&&value.address){value.address.toString=function(){return addressToString(value.address)}}return value}function WhatBrowser(source){var self=this;self.browser_size=browserSize(source);self.cookies=cookies(source);self.flash=null;self.javafn=javafn(source);self.language=language(source);self.online=online(source);self.screenfn=screenfn(source);self.ua=ua(source);self.geo=geo(source&&source.geo||undefined)}window.WhatBrowser=WhatBrowser;return WhatBrowser})(window.jQuery,window.UAParser);(function(JSON,LZString){"use strict";window.Hashcode={parse:JSON.parse,serialize:JSON.stringify,compress_base64:LZString.compressToBase64,decompress_base64:LZString.decompressFromBase64};return window.Hashcode})(window.JSON,window.LZString);(function($,Cookies,Hashcode,WhatBrowser){"use strict";function log(message){return message}function get_id(){function get_id_url(){var hash=window.location.hash;if(hash&&hash.substr(0,2)==="#!"){return{value:hash.substr(2),local:false}}return null}function get_id_cookies(){if(Cookies.enabled){var id=Cookies.get("whatbrowser");if(id){return{value:id,local:true}}}return null}return get_id_url()||get_id_cookies()||{value:null,local:true}}function get_long_link(whatbrowser){try{var whatbrowser_str=Hashcode.serialize(whatbrowser),hash=Hashcode.compress_base64(whatbrowser_str);return{hash:hash,full:window.location.origin+"/#!"+hash}}catch(e){return null}}function create(){var whatbrowser=new WhatBrowser;whatbrowser.link=get_long_link(whatbrowser);return whatbrowser}function update(id,whatbrowser){}function load_from_str(id){var whatbrowser=null;log("Loading info from string: "+id);try{var whatbrowser_str=Hashcode.decompress_base64(id);whatbrowser=new WhatBrowser(Hashcode.parse(whatbrowser_str));whatbrowser.link=get_long_link(whatbrowser);whatbrowser.id=whatbrowser.link.hash.substr(0,3)+whatbrowser.link.hash.substr(-5,3);log("Loaded info")}catch(e){log("Failed to load info: "+e)}return whatbrowser}function load(id){return load_from_str(id)}window.WhatBrowserManager={get_id:get_id,create:create,load:load};return window.WhatBrowserManager})(window.jQuery,window.Cookies,window.Hashcode,window.WhatBrowser);(function($,ClipboardJS,WhatBrowserManager){"use strict";function render_property(name,value){var str_value=value&&value.toString&&value.toString()||""+value;if(str_value==="undefined"||!str_value){return""}return"<tr>"+"<th>"+name+"</th>"+"<td>"+str_value+"</td>"+"</tr>"}function render_info(whatbrowser){var properties="";properties+=render_property("Куки",whatbrowser.cookies?"да":"нет");properties+=render_property("Язык",whatbrowser.language);properties+=render_property("Страница",whatbrowser.browser_size);properties+=render_property("Экран",whatbrowser.screen);properties+=render_property("Браузер",whatbrowser.ua&&whatbrowser.ua.browser);properties+=render_property("Движок",whatbrowser.ua&&whatbrowser.ua.engine);properties+=render_property("ОС",whatbrowser.ua&&whatbrowser.ua.os);properties+=render_property("Устройство",whatbrowser.ua&&whatbrowser.ua.device);properties+=render_property("Юзер-агент",whatbrowser.ua);return properties}function render_header(whatbrowser,own){var header_msg="";if(!own){header_msg="Сохраненный браузер: "+'<a href="'+whatbrowser.link.full+'">'+whatbrowser.ua.browser.name+" "+whatbrowser.ua.browser.major+(whatbrowser.ua.os.name?" на "+whatbrowser.ua.os.name:"")+"</a>"}else if(whatbrowser.ua.browser.name){header_msg="У вас "+whatbrowser.ua.browser.name+" "+whatbrowser.ua.browser.major;header_msg+=whatbrowser.ua.os.name?" на "+whatbrowser.ua.os.name:""}else{header_msg="У вас неизвестный науке браузер :-["}return header_msg}function show_links(whatbrowser){$("#copy-value").val(whatbrowser.link.full)}function show_info(whatbrowser,own){var $details=$("#details-table").children("tbody"),header=render_header(whatbrowser,own);$details.html(render_info(whatbrowser));if(own){$("#header-msg").html(header);show_links(whatbrowser)}else{$("#details-msg").html(header);$("#header").hide()}$("#message").hide();$("#result").fadeIn()}function show(id){var whatbrowser;if(id){whatbrowser=WhatBrowserManager.load(id);show_info(whatbrowser,false)}else{whatbrowser=WhatBrowserManager.create();show_info(whatbrowser,true)}}function get_origin(){return window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function render(){var id=WhatBrowserManager.get_id();show(id.value)}function init_ui(){if(!window.location.origin){window.location.origin=get_origin()}$(window).on("hashchange",render);$(".link-text").click(function(){if(this.setSelectionRange){this.setSelectionRange(0,9999)}else{$(this).select()}});var clipboard=new ClipboardJS("#info-link button");clipboard.on("success",function(e){var $status=$("#copy-status");$status.text("✓ скопировано");window.setTimeout(function(){$status.text("")},500)})}$(function(){init_ui();render()})})(window.jQuery,window.ClipboardJS,window.WhatBrowserManager);